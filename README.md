# Coursera_Duke_SQL

Database ua_dillards;
SELECT sku, retail, cost, COUNT(sku)
FROM skstinfo
GROUP BY sku, retail, cost;
SELECT COUNT(DISTINCT t.sku),t.sku,t.store
FROM trnsact t JOIN skstinfo s
  ON t.sku=s.sku AND t.store=s.store
GROUP BY t.sku, t.store;
SHOW TABLE TRNSACT;
SELECT SUM(SPRICE) AS SUMSPRICE,SALEDATE
FROM TRNSACT
GROUP BY SALEDATE
ORDER BY SUMSPRICE DESC;
SHOW TABLE skstinfo;
SHOW TABLE deptinfo;
SELECT D.DEPTDESC,COUNT(DISTINCT S.SKU)
FROM DEPTINFO D, SKSTINFO S
WHERE D.DEPT=S.STORE
GROUP BY D.DEPTDESC
ORDER BY COUNT(S.SKU) DESC;
SELECT SKU,
FROM SKSTINFO;
SELECT COUNT(DISTINCT sku)
FROM SKSTINFO;

SELECT COUNT(DISTINCT sku)
FROM SKUINFO;

SELECT COUNT(DISTINCT sku)
FROM TRNSACT;

SELECT COUNT(DISTINCT sku)
FROM DEPTINFO;

SHOW TABLE SKUINFO;
SHOW TABLE SKSTINFO;
SHOW TABLE TRNSACT;
SHOW TABLE DEPTINFO;
SHOW TABLE STORE_MSA;

SELECT *
FROM SKUINFO A LEFT JOIN SKSTINFO B ON A.SKU=B.SKU
WHERE B.RETAIL IS NULL;

SELECT SUM(A.AMT-B.COST)/COUNT(DISTINCT A.SALEDATE)
FROM TRNSACT A JOIN SKSTINFO B ON A.SKU=B.SKU AND A.STORE=B.STORE;

SELECT COUNT(MSA),MIN(MSA_POP),MAX(MSA_INCOME)
FROM STORE_MSA
WHERE STATE='NC';

SELECT SUM(C.AMT),A.COLOR,A.BRAND,A.STYLE,B.DEPT,B.DEPTDESC
FROM SKUINFO A, DEPTINFO B, TRNSACT C
WHERE A.SKU=C.SKU AND A.DEPT=C.STORE AND C.STORE=B.DEPT
GROUP BY A.COLOR,A.BRAND,A.STYLE,B.DEPTDESC,B.DEPT
ORDER BY SUM(C.AMT) DESC;

SELECT COUNT(DISTINCT SKU) AS TOTE
FROM SKSTINFO
GROUP BY STORE
HAVING TOTE>180000;
